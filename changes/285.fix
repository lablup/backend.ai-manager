Further split DB transactions in the scheduler to eliminate daedlock timeout errors
